# Copyright 2016-2017 Anthony Wratten
# All rights reserved
# Last Revised: 28/06/2017
#
#
# Script to download a list of builders histories from QBCC website base on license number
# Collects licence numbers & names from an array [[LicenceNumber,'Builder Name']]
#
# Designed for: Firefox Version 46, Selenium-2.53.5, Python 3.4, lxml
#
# python.exe -m pip install selenium==2.53.5 --force-reinstall
#
# Version: 3.0 Exp
#
# New Features: Multiprocessing now added

from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.firefox.firefox_binary import FirefoxBinary

from multiprocessing import Pool
import multiprocessing

import time, csv, sys, math, tqdm

binary = FirefoxBinary('D:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe')

timestr = time.strftime("%Y%m%d") #Timestamp for Each day

legal_name = ''
ar_Builder_LIC = [] #array of Licence numbers
ar_Builder_name = [] #array of Builders Names
batch_data = []

alternate_filename_offset = ''

#Generate File Paths
#FolderPATH = "/home/user/buildreport/" #linux Path
FolderPATH = "D:\\Builder_PDF_temp\\"
Data_FilePath = FolderPATH + timestr + alternate_filename_offset + '_List.csv'


def GetCurrentFinancialYear():
	LastMonth = 6 # Last month of the financial year eg. June would be : 6
	CurrentYear = int(time.strftime("%Y"))
	PreviousYear = int(time.strftime("%Y")) - 1
	NextYear = int(time.strftime("%Y")) + 1
	FinYear = ""
	if (int(time.strftime("%m")) > LastMonth):
		FinYear = str(CurrentYear) + "/" + str(NextYear)
	else:
		FinYear = str(PreviousYear) + "/" + str(CurrentYear)
	return FinYear

F_Year = GetCurrentFinancialYear()



def create_csv(filepath,init_data): #Create CSV File
	try:
		with open(filepath, 'w', newline='') as fp:
			Create_csv = csv.writer(fp, delimiter=',')
			Create_csv.writerow(init_data)
	except IOError:
		print ("CSV File Error!")


def write_record_csv(filepath, data):
	with open(filepath,'a',newline='') as fp:
		writer = csv.writer(fp, delimiter=',')
		writer.writerow(data)


def getTextFromID(id):
	global tree
	if id:
		id = "#" + id
		return CSSSelector(str(id))(tree)[0].text_content()


def download_builder_history(iniArray):
	try:
		#Generate QBCC Direct URL to Builders Page from QBCC Number
		if len(iniArray) == 1:
			LIC = iniArray[0]
			Builder_Name = ""
		if len(iniArray) == 2:
			LIC = iniArray[0]
			Builder_Name = iniArray[1]

		driver = webdriver.Firefox(firefox_binary=binary)
		URL = 'http://www.onlineservices.qbcc.qld.gov.au/OnlineLicenceSearch/VisualElements/ShowDetailResultContent.aspx?&LicNO=' + str(LIC) + '&licCat=LIC&name=&firstName=&searchType=Contractor'
		driver.get(URL) #Navigate to that URL
		legal_name_element = driver.find_element_by_id("ctl00_generalContentPlaceHolder_LicenceInfoControl1_lbLicenceName") #Find the Builders Name

		legal_name = "".join(legal_name_element.text.split()) #Remove all Spaces and make into String

		KFelem = driver.find_element_by_css_selector('#ctl00_generalContentPlaceHolder_LicenceInfoControl1_btnCreateLicenseeHistory') #Find Button "Licensees full history"
		KFelem.click() #Click The button

		timeout = 5

		try:
			element_present = EC.presence_of_element_located((By.ID, 'pageContainer1'))
			WebDriverWait(driver, timeout).until(element_present)

		except TimeoutException:
			print("Timed out waiting for page to load")

		body_el = driver.find_element_by_tag_name('body')

		for i in range(8):
			body_el.send_keys(Keys.PAGE_DOWN)
		time.sleep(0.5)
		
		year = driver.find_element_by_xpath("//div[contains(text(),'" + F_Year + "')]")
		Jobs = driver.find_element_by_xpath("//*[contains(text(), '" + F_Year + "')]/following-sibling::div")
		Price = driver.find_element_by_xpath("//*[contains(text(), '" + F_Year + "')]/following-sibling::div/following-sibling::div")
		
		print(legal_name + ' - ' + year.text + ' - ' + Jobs.text + ' - ' + Price.text)
		write_record_csv(Data_FilePath, [LIC, legal_name, Builder_Name, Jobs.text, Price.text,''])

		#time.sleep(1)
		driver.quit()

	except:
		write_record_csv(Data_FilePath, [LIC, '_', Builder_Name, '0', '0',''])
		print ("error: " + str(LIC) + " : " + str(Builder_Name))
		
		time.sleep(1)
		driver.quit()
		return


if __name__ == '__main__':

	threads = int(multiprocessing.cpu_count()/2) # only use real cores
	if (threads < 1):
		threads = 1

	
	# tasks = [[1319309],[1318586],[1317869],[1317532],[1316066],[1315741],[1315484],[1314869],[1311690],[1310408],[1309690],[1308344],[1307025],[1303863],[1301454],[1301072],[1297461],[1296093],[1295512],[1294869],[1292447],[1280181],[1277157],[1276674],[1275578],[1275363],[1274443],[1272888],[1272090],[1270358],[1268852],[1268288],[1267712],[1267654],[1266279],[1261106],[1260900],[1258838],[1257425],[1256314],[1255922],[1255907],[1255424],[1253861],[1253585],[1252050],[1250464],[1248548],[1247951],[1238922],[1236895],[1236811],[1235818],[1233923],[1233166],[1229034],[1221264],[1220407],[1218463],[1217632],[1216420],[1215801],[1211018],[1210738],[1209195],[1208983],[1208334],[1208333],[1207960],[1206430],[1204682],[1197611],[1192661],[1191314],[1191147],[1188419],[1187957],[1187898],[1185044],[1181070],[1178813],[1175949],[1175945],[1175794],[1165956],[1165628],[1163345],[1162202],[1159433],[1158473],[1157917],[1157803],[1156272],[1156159],[1152129],[1152036],[1149711],[1149710],[1148693],[1148692],[1145155],[1143909],[1142849],[1140413],[1139785],[1138379],[1136937],[1133465],[1133420],[1133080],[1132704],[1132105],[1132067],[1131559],[1128089],[1127583],[1127270],[1126504],[1124829],[1124552],[1123196],[1117517],[1117499],[1117048],[1115166],[1115120],[1114838],[1114195],[1113517],[1113268],[1112842],[1111875],[1109653],[1109584],[1109130],[1107907],[1107156],[1104869],[1103321],[1102859],[1095153],[1094869],[1092932],[1088907],[1088621],[1088415],[1084786],[1082633],[1081266],[1076357],[1070886],[1070685],[1070342],[1067337],[1065430],[1063987],[1063450],[1061897],[1054144],[1051692],[1049271],[1049071],[1048691],[1044869],[1041864],[1041539],[1040042],[1036026],[1033963],[1032736],[1029427],[1027532],[1025786],[1020238],[1019911],[1016986],[1012736],[1011505],[1010671],[1007600],[1003385],[1002935],[1002598],[894544],[889130],[884775],[884566],[884007],[845904],[745738],[745483],[745218],[744988],[744967],[743538],[743299],[737309],[1319839],[1319835],[1319708],[1319579],[1319482],[1319149],[1319128],[1318739],[1318691],[1318423],[1318422],[1318364],[1318231],[1318040],[1317470],[1317465],[1316689],[1316656],[1316593],[1316323],[1316228],[1316130],[1315062],[1314840],[1313370],[1312800],[1312726],[1312483],[1312360],[1311700],[1311511],[1311510],[1311131],[1311097],[1310804],[1310602],[1309936],[1309750],[1309615],[1309466],[1309433],[1309359],[1309156],[1308188],[1308156],[1307920],[1307828],[1307537],[1306996],[1306517],[1306190],[1306111],[1305787],[1305425],[1304942],[1304834],[1304197],[1303889],[1303877],[1302930],[1302926],[1302837],[1302791],[1302744],[1302528],[1301631],[1301539],[1300951],[1300733],[1300107],[1297477],[1297297],[1296582],[1295642],[1293720],[1287178],[1286924],[1286586],[1286412],[1285181],[1284954],[1284726],[1284499],[1284457],[1284167],[1284128],[1283904],[1282977],[1282840],[1282567],[1282189],[1281616],[1280952],[1280657],[1279643],[1279395],[1279086],[1279091],[1278469],[1278257],[1277439],[1276975],[1275276],[1275028],[1274333],[1272209],[1271959],[1271945],[1270816],[1270755],[1270317],[1269500],[1269310],[1269261],[1268445],[1267655],[1267368],[1267117],[1266511],[1266233],[1265320],[1265114],[1264685],[1264393],[1263209],[1262807],[1262725],[1261990],[1260628],[1260464],[1260141],[1259763],[1259708],[1258502],[1258499],[1258092],[1257734],[1257483],[1256869],[1256851],[1256083],[1255365],[1254991],[1254097],[1253583],[1252282],[1251562],[1251508],[1251004],[1250362],[1250267],[1249802],[1248707],[1248706],[1247870],[1247787],[1247114],[1246935],[1245993],[1244697],[1244689],[1244239],[1244224],[1243412],[1242615],[1241830],[1240706],[1240374],[1239966],[1239449],[1238730],[1238035],[1237672],[1237456],[1237240],[1236522],[1236414],[1236071],[1235392],[1235391],[1233991],[1233260],[1232586],[1232002],[1231299],[1230746],[1230058],[1229565],[1229497],[1229552],[1226660],[1225280],[1224517],[1223444],[1222707],[1222637],[1222022],[1221598],[1221262],[1221088],[1221016],[1220006],[1219806],[1219503],[1218487],[1218188],[1217923],[1217711],[1216443],[1215983],[1215683],[1215340],[1214668],[1213436],[1213219],[1212675],[1212471],[1212433],[1212364],[1212128],[1212072],[1211641],[1211461],[1211337],[1211127],[1211096],[1210960],[1210671],[1210033],[1209397],[1208700],[1208679],[1208680],[1208389],[1208270],[1207840],[1207830],[1207233],[1206991],[1206760],[1206696],[1206685],[1206520],[1205926],[1205770],[1205641],[1205045],[1204378],[1204369],[1203777],[1203734],[1202765],[1202763],[1202693],[1202602],[1202310],[1201644],[1201355],[1201279],[1201218],[1201099],[1200986],[1200665],[1200611],[1200592],[1200231],[1199854],[1199825],[1199657],[1199456],[1199332],[1199327],[1199237],[1199204],[1199139],[1199137],[1198383],[1198382],[1197996],[1197549],[1197106],[1197042],[1196575],[1195642],[1195635],[1195523],[1195241],[1195145],[1195141],[1194274],[1194251],[1193751],[1193216],[1193092],[1192820],[1192462],[1192433],[1192311],[1192139],[1192041],[1191996],[1191850],[1191783],[1190797],[1190307],[1190202],[1189448],[1189131],[1189110],[1188740],[1188731],[1188541],[1188172],[1187626],[1187550],[1187420],[1186968],[1186894],[1186542],[1186057],[1185080],[1184101],[1183280],[1181506],[1181258],[1181115],[1180948],[1180632],[1180624],[1180393],[1180364],[1179933],[1179722],[1179482],[1179481],[1179136],[1178706],[1178336],[1178085],[1177542],[1176987],[1176589],[1176258],[1176023],[1175998],[1175853],[1174611],[1173872],[1171959],[1171491],[1171090],[1169713],[1169629],[1169368],[1169349],[1169289],[1168308],[1168072],[1167497],[1166638],[1166559],[1165955],[1165841],[1165125],[1165004],[1165003],[1165001],[1164735],[1164409],[1164388],[1164394],[1164389],[1164075],[1162790],[1161783],[1161742],[1161373],[1161266],[1161095],[1160689],[1160632],[1160372],[1160037],[1159960],[1159946],[1159907],[1159464],[1159401],[1159048],[1158992],[1158795],[1158764],[1158751],[1158644],[1158560],[1158346],[1158216],[1158214],[1157325],[1156733],[1156584],[1155907],[1155821],[1155810],[1155799],[1155610],[1155210],[1155080],[1154927],[1154715],[1154685],[1154426],[1154335],[1154208],[1153635],[1153579],[1152464],[1152207],[1151898],[1151723],[1150832],[1150654],[1150541],[1150437],[1150207],[1150087],[1150013],[1149473],[1149074],[1149069],[1149052],[1149042],[1148708],[1148362],[1148005],[1147594],[1146530],[1146428],[1146408],[1146310],[1145823],[1145817],[1145758],[1145530],[1145524],[1145418],[1145303],[1145014],[1144908],[1144859],[1144747],[1144542],[1144197],[1143929],[1143630],[1143266],[1143226],[1142804],[1142555],[1142479],[1142304],[1142251],[1142062],[1141987],[1141458],[1141286],[1140797],[1140727],[1139855],[1139706],[1138851],[1138780],[1138494],[1138423],[1138306],[1138048],[1137770],[1137766],[1137757],[1137758],[1137595],[1137181],[1136617],[1136530],[1136467],[1135868],[1135723],[1135535],[1133680],[1133670],[1133340],[1133194],[1132483],[1132333],[1131776],[1131447],[1130780],[1130302],[1130049],[1129327],[1128915],[1128775],[1127956],[1126985],[1126352],[1125544],[1125537],[1125326],[1124763],[1124724],[1124618],[1124579],[1124140],[1123486],[1123229],[1122796],[1122471],[1122387],[1122011],[1121530],[1121262],[1120955],[1120353],[1120168],[1120103],[1120093],[1119872],[1119214],[1119053],[1118933],[1118505],[1118398],[1118387],[1118324],[1118239],[1117925],[1117489],[1116888],[1116049],[1115793],[1115752],[1115422],[1114874],[1114783],[1114671],[1114233],[1114209],[1114093],[1113822],[1113759],[1113743],[1113627],[1112234],[1112172],[1112142],[1111787],[1111255],[1111015],[1110837],[1110794],[1110028],[1109892],[1109891],[1109627],[1109308],[1109146],[1109126],[1108920],[1108250],[1108212],[1108100],[1107770],[1107758],[1107549],[1106798],[1106315],[1106216],[1105464],[1105071],[1105064],[1104909],[1104898],[1104870],[1102465],[1102252],[1102204],[1100752],[1100583],[1100567],[1100342],[1100343],[1100317],[1099314],[1098681],[1097485],[1096444],[1096103],[1095972],[1095971],[1095752],[1095559],[1095523],[1095272],[1094390],[1093542],[1093223],[1092728],[1092723],[1092312],[1091920],[1091770],[1090712],[1090205],[1090162],[1089846],[1089840],[1088654],[1088592],[1088455],[1088239],[1087376],[1087315],[1086752],[1086553],[1086548],[1086264],[1085499],[1085127],[1084517],[1084114],[1084044],[1083970],[1083969],[1083163],[1082394],[1081771],[1081355],[1081232],[1080249],[1080245],[1078921],[1078878],[1077338],[1076876],[1076281],[1075312],[1075037],[1073677],[1073611],[1073570],[1073272],[1071343],[1071319],[1071190],[1070260],[1069495],[1069091],[1069055],[1068691],[1067753],[1067013],[1065735],[1065497],[1064962],[1064447],[1064419],[1064259],[1063927],[1063459],[1063435],[1062597],[1062262],[1061889],[1061414],[1061210],[1061173],[1061091],[1060874],[1060819],[1060430],[1060207],[1060131],[1059858],[1059429],[1058427],[1057712],[1056639],[1053945],[1052928],[1051316],[1050874],[1050868],[1050533],[1050393],[1050088],[1049310],[1048645],[1047115],[1046598],[1045454],[1044068],[1043797],[1043119],[1042268],[1041620],[1041587],[1039537],[1039534],[1038995],[1038272],[1037444],[1036685],[1035361],[1035340],[1035244],[1035139],[1035143],[1035044],[1034970],[1034760],[1034668],[1034319],[1033829],[1033596],[1033320],[1032862],[1032740],[1032622],[1031439],[1031322],[1030974],[1030911],[1030819],[1030437],[1030408],[1030382],[1030167],[1029994],[1029073],[1029011],[1026479],[1024979],[1024956],[1024777],[1023930],[1023734],[1023553],[1022648],[1022407],[1022362],[1021597],[1020622],[1020139],[1019805],[1019744],[1019268],[1019164],[1018932],[1018926],[1018553],[1018023],[1018021],[1018024],[1017855],[1017447],[1017384],[1016750],[1015384],[1015222],[1014462],[1013168],[1012389],[1012060],[1011162],[1010968],[1010848],[1009766],[1009473],[1009342],[1008531],[1008516],[1008513],[1008506],[1008032],[1007348],[1006907],[1006602],[1005773],[1005292],[1005043],[1004916],[1004617],[1004169],[1003576],[1002767],[1002746],[1001804],[1000554],[1000101],[898470],[898118],[897614],[896970],[896962],[896305],[893891],[893632],[893069],[891826],[890705],[887412],[887076],[885187],[884161],[884006],[884004],[883583],[883318],[883239],[882778],[747135],[747114],[746185],[746163],[745832],[745759],[745670],[745652],[745398],[745381],[745352],[745344],[745335],[745146],[744751],[744538],[744497],[744463],[743826],[743393],[742437],[742398],[742253],[741727],[741155],[740579],[740571],[740166],[739638],[738485],[738253],[737844],[737113],[1319729],[1319728],[1317315],[1315644],[1314245],[1308351],[1307810],[1307809],[1305105],[1303164],[1301560],[1294878],[1286282],[1285623],[1284878],[1283633],[1282743],[1282108],[1281547],[1281355],[1280899],[1280757],[1278568],[1276583],[1276273],[1275368],[1273281],[1271820],[1268540],[1266650],[1265893],[1261500],[1260372],[1255242],[1255033],[1253854],[1250006],[1249343],[1249256],[1248780],[1245708],[1237627],[1228456],[1224179],[1220635],[1218438],[1216053],[1211509],[1211504],[1211341],[1205805],[1203751],[1203654],[1202425],[1201601],[1201483],[1201375],[1201293],[1200115],[1197785],[1197452],[1197111],[1196323],[1196148],[1195473],[1189818],[1189179],[1187508],[1186461],[1183255],[1182048],[1181917],[1178363],[1177482],[1177050],[1175184],[1174284],[1171386],[1169915],[1167048],[1165429],[1162780],[1161838],[1160340],[1156048],[1155796],[1155377],[1154918],[1151860],[1150719],[1150244],[1148337],[1147584],[1142390],[1140283],[1140233],[1138019],[1133719],[1133031],[1128774],[1127115],[1126660],[1126597],[1123381],[1123202],[1121762],[1121282],[1120176],[1118154],[1117943],[1117525],[1117450],[1114957],[1112724],[1111352],[1111239],[1110829],[1107503],[1106746],[1101029],[1099605],[1098634],[1096105],[1095266],[1093112],[1092330],[1090309],[1088324],[1087312],[1084785],[1084744],[1081725],[1078970],[1078362],[1078522],[1076881],[1073655],[1072332],[1067612],[1067595],[1065314],[1056642],[1050701],[1050440],[1049231],[1044369],[1041933],[1036980],[1036036],[1035390],[1035123],[1034886],[1034752],[1033955],[1033529],[1032623],[1023745],[1020112],[1019431],[1018762],[1018624],[1015658],[1013221],[1013222],[1006479],[1006078],[894138],[893673],[889122],[805706],[768004],[744878],[742444],[741810],[737172],[737106],[1319277],[1318514],[1317350],[1315939],[1315907],[1315301],[1315068],[1313661],[1313657],[1313147],[1309949],[1309947],[1309497],[1308836],[1307845],[1307807],[1307255],[1306632],[1306080],[1305456],[1305095],[1304879],[1304822],[1304814],[1304696],[1304103],[1301688],[1300968],[1297072],[1296344],[1296233],[1287053],[1286883],[1286369],[1286220],[1285880],[1284838],[1283232],[1282033],[1281696],[1279271],[1279243],[1278777],[1277679],[1277550],[1273395],[1272446],[1272310],[1269481],[1268236],[1266337],[1263650],[1263444],[1262663],[1261113],[1259002],[1252386],[1251588],[1249830],[1249271],[1247786],[1246976],[1243487],[1240677],[1234993],[1233667],[1229455],[1229316],[1227405],[1226064],[1223760],[1221899],[1218474],[1217469],[1216310],[1216174],[1215482],[1215391],[1213700],[1213427],[1212472],[1210847],[1210387],[1209453],[1207965],[1207586],[1207381],[1206473],[1204851],[1204100],[1203736],[1202588],[1202510],[1194168],[1192669],[1189720],[1188561],[1187642],[1187445],[1186037],[1185030],[1184879],[1184554],[1183055],[1182067],[1181126],[1180582],[1180546],[1179593],[1179521],[1175245],[1173733],[1172192],[1172064],[1170228],[1168946],[1164879],[1164348],[1163818],[1163230],[1161662],[1158425],[1156039],[1154879],[1153661],[1153585],[1150777],[1150243],[1149251],[1148727],[1148391],[1147567],[1147563],[1146580],[1145852],[1145520],[1145290],[1142362],[1142360],[1141769],[1141311],[1140572],[1139313],[1139275],[1139111],[1138610],[1138566],[1137573],[1137379],[1137006],[1135696],[1135695],[1133933],[1133539],[1131628],[1130133],[1130130],[1128163],[1127429],[1127255],[1126783],[1125737],[1125543],[1125499],[1125418],[1125336],[1124847],[1124366],[1124072],[1123427],[1122459],[1121920],[1121306],[1120733],[1120703],[1119848],[1119614],[1119584],[1119438],[1117231],[1116746],[1113625],[1112290],[1111050],[1108134],[1107810],[1107803],[1107117],[1103753],[1102427],[1101121],[1097250],[1096913],[1095728],[1094924],[1094023],[1094022],[1093599],[1089069],[1088254],[1087932],[1087560],[1086562],[1086245],[1085812],[1082032],[1077942],[1076092],[1075469],[1075346],[1074625],[1072021],[1071807],[1071659],[1067987],[1066607],[1063297],[1063050],[1062945],[1061915],[1059433],[1058418],[1057910],[1057596],[1056918],[1052506],[1051705],[1050247],[1049998],[1048794],[1048791],[1048633],[1047953],[1046746],[1045677],[1042797],[1041512],[1040422],[1040404],[1037623],[1036301],[1035129],[1035066],[1034879],[1033895],[1033477],[1028802],[1024229],[1023712],[1013347],[1011150],[1010429],[1010425],[1008559],[1008107],[1006934],[1006388],[1004587],[1001744],[899496],[896748],[889417],[888242],[885730],[884216],[865323],[796606],[745717],[743950],[741525],[741024],[740873],[738966],[737821],[737109],[737068],[735830],[1315357],[1315305],[1313320],[1296817],[1296405],[1295871],[1287477],[1282034],[1272008],[1271999],[1271676],[1264637],[1260343],[1259168],[1256130],[1256080],[1254564],[1249893],[1248865],[1244865],[1244666],[1243399],[1239220],[1231556],[1231193],[1224865],[1212663],[1209719],[1208085],[1205983],[1205083],[1205084],[1199830],[1191543],[1187836],[1181364],[1174084],[1171222],[1166257],[1165513],[1164594],[1163228],[1162425],[1154183],[1148659],[1148656],[1147412],[1144021],[1142850],[1141766],[1139885],[1135160],[1134865],[1124733],[1123646],[1113487],[1103727],[1100501],[1100029],[1094865],[1093023],[1086244],[1080978],[1080739],[1080506],[1079284],[1072498],[1069071],[1065349],[1064871],[1048656],[1048651],[1046121],[1042640],[1035247],[1029313],[1028722],[1026786],[1024865],[1024227],[1023004],[1020753],[1012888],[1011723],[1011434],[1011415],[1009505],[1004569],[1002863],[1002828],[1000123],[896539],[891057],[745282],[745250],[743666],[743249],[740679],[736950],[735677],[7368],[7679],[8447],[8518],[8925],[9083],[9702],[9957],[10410],[10483],[10505],[10907],[10920],[11233],[11727],[11774],[11992],[12196],[12451],[12653],[12816],[12867],[13015],[13348],[13425],[14134],[14179],[14285],[14325],[14461],[14749],[15034],[15782],[15877],[16038],[16149],[16220],[16361],[17263],[17333],[17687],[17765],[17799],[17994],[18032],[18081],[18097],[18378],[18582],[18714],[18800],[18837],[18888],[18899],[19304],[19475],[19543],[19598],[19655],[19634],[19692],[19714],[19760],[19805],[20031],[20391],[20706],[20694],[20742],[20788],[20816],[20962],[21028],[21137],[21382],[21428],[21526],[21605],[21788],[21904],[22326],[22391],[22468],[22626],[22881],[22904],[22946],[23024],[23228],[23655],[23750],[23789],[23855],[24001],[24083],[24106],[24249],[24273],[24294],[24312],[24327],[24448],[24472],[24545],[24590],[24680],[24833],[24870],[24952],[25114],[25190],[25257],[25524],[25580],[30916],[30934],[31481],[31645],[31937],[31944],[31960],[32012],[32091],[32105],[32209],[40085],[40129],[40322],[40440],[40545],[40664],[40810],[40867],[40971],[41122],[41174],[41197],[41292],[41305],[41579],[41588],[41831],[41951],[42000],[42001],[42082],[42229],[42585],[42600],[42667],[42686],[42687],[42696],[42729],[42782],[42838],[42847],[42955],[43045],[43068],[43104],[43672],[44034],[44087],[44131],[44219],[44243],[44865],[44870],[44947],[44951],[44952],[45108],[45192],[45194],[45218],[45269],[45650],[45842],[45871],[45966],[46102],[46134],[46267],[46544],[46772],[46792],[46857],[46869],[47089],[47250],[47764],[48702],[48703],[48704],[48707],[48859],[48907],[49043],[49212],[49383],[49493],[49552],[49573],[50247],[50531],[50615],[50767],[50871],[50938],[50950],[51064],[51179],[51442],[51454],[51497],[51547],[51574],[51612],[51809],[51918],[52073],[52191],[52265],[52571],[52694],[52731],[52737],[52746],[53016],[53049],[53469],[53474],[53492],[53509],[53687],[53769],[53803],[53869],[53889],[53946],[53988],[54221],[54215],[54331],[54508],[54688],[54689],[54777],[54829],[54832],[54853],[54988],[55311],[55421],[55695],[55786],[55788],[55789],[55791],[55799],[55919],[56178],[56250],[56253],[56254],[56249],[56258],[56257],[56397],[56492],[56548],[56714],[57069],[57183],[57198],[57477],[58010],[58151],[58464],[58770],[58994],[59047],[59552],[59578],[59639],[59640],[59662],[60152],[60238],[60242],[60487],[61120],[61328],[61327],[61538],[61749],[61831],[62108],[62418],[62479],[62486],[62497],[62528],[62758],[62759],[62796],[63059],[63136],[63454],[63457],[63464],[63494],[63759],[63778],[64015],[64535],[64539],[64634],[64637],[64781],[64828],[65162],[65166],[65813],[65898],[65993],[66124],[66125],[66261],[66263],[66268],[66266],[66357],[66490],[66606],[66699],[66985],[66990],[67017],[67053],[67056],[67063],[67066],[67071],[67499],[67498],[67805],[67945],[67948],[67947],[67807],[67943],[68081],[68373],[68378],[68418],[68461],[68637],[68632],[68792],[68801],[69492],[69649],[69738],[69935],[70164],[70252],[70340],[70583],[70585],[70589],[70776],[71062],[71249],[71474],[71628],[71829],[72144],[72498],[72620],[72675],[72674],[72702],[73005],[73065],[73152],[73198],[73197],[73295],[73326],[73554],[73614],[73619],[73738],[74050],[74081],[74454],[74525],[74563],[74690],[74785],[75062],[75275],[75317],[75660],[75689],[75980],[75998],[76137],[76149],[76157],[76192],[76234],[76235],[76441],[76443],[76688],[76705],[76740],[76792],[76851],[76881],[76886],[76876],[76909],[77116],[77117],[77286],[77287],[77383],[77446],[77511],[77529],[77687],[77922],[77970],[77971],[78120],[78232],[78323],[78404],[78477],[78489],[78611],[78659],[78697],[78709],[78776],[78801],[78806],[78867],[78890],[78901],[78907],[79088],[79200],[79377],[79501],[79673],[79685],[79706],[79722],[79742],[79904],[79958],[80046],[80195],[80324],[80395],[80416],[80501],[80634],[80700],[80767],[80839],[80880],[80961],[81211],[81315],[81637],[81749],[81748],[81863],[81890],[81897],[82015],[82109],[82128],[82109],[82128]]


	


	tasks = [[1008531,'Kenfrost Homes'],[1199139,'Bridgewater Builders'],[1138780,'Hedley Homes'],[1033596,'Cougar Homes'],[1199456,'MyStyle Homes'],[78120,'Dixon Homes Cairns'],[1200115,'Austart Homes - Cairns'],[1269681,'Positive Advantage'],[1096103,'GJ gardner'],[31645,'Value Homes'],[1008032,'Allaro Homes - Cairns'],[1147412,'Ashlee Jones Homes'],[1263825,'DCConstructions'],[1174611,'Duce Constructions'],[1246976,'SJ Lloyd Construction'],[1209719,'Michael Hoare Builders'],[1115793,'Maxa'],[1075037,'Strategic Builders'],[1176258,'Kenick Constructions'],[1251783,'Nathan Verri'],[1032862,'MV Designer Homes'],[1190202,'Dorahy Builders'],[1209108,'A & C CONSTRUCTIONS NQ'],[1163228,'Eden by Design Builders'],[1133933,'Brendan Grant Homes'],[1143159,'Pav Constructions'],[80870,'Ash Moseley Homes'],[1189818,'Unique Constructions'],[82109,'East Coast Designer Builders'],[12816,'Wedmaier Homes'],[1181070,'Brennan Constructions'],[71474,'Affinity Designer Homes'],[1012389,'Manning Builders'],[21788,'Neater Constructions'],[81693,'Reilly Building Projects'],[1317350,'Modern Rustic'],[1076708,'Austart Homes - Tablelands'],[51497,'Cairns Quality Homes'],[730959,'Craig Burrows'],[1211341,'Custom Built Homes'],[1105464,'MD Can Do Constructions'],[1089069,'Dean Homes'],[1124847,'Tropical Trend Homes'],[75319,'Eastbuild'],[1239643,'Fineline Constructions'],[1189718,'Unique Constructions'],[1144021,'Ashlee Jones - Personal'],[1117517,'Laurence Court'],[1280401,'JAJD Builders'],[1281355,'Phil Kelly Builders'],[1256130,'Matt Greenwood'],[1308188,'Fineline Constructions NQ']]
	
	create_csv(Data_FilePath, ['LicNO','Legal Name','Builder Name', 'Jobs', 'Price', 'Comments'])
	
	pool = Pool(processes=threads)
	for _ in tqdm.tqdm(pool.imap_unordered(download_builder_history, tasks), total=len(tasks)):
		pass


#tasks = [['OB135180','162 Camille Drive'],['OB135181','26 Chandos Street'],['OB135182','27 HUCKER St'],['OB135183','29 GOULBURN Street'],['OB135184','10 COUNTRYVIEW Court'],['OB135185','31-33 Siganto Street'],['OB135186','Christies Road'],['OB135187','36 TOWNSVILLE Road'],['OB135188','17 Mallard Place'],['OB135189','7 Ridgeway Street'],['OB135190','144 KIRBYS Road'],['OB135191','161 Guanaba Road'],['OB135192','44 Poopoonbah Road'],['OB135193','42 Chiswick Road'],['OB135194','2 Palmwood Drive'],['OB135195','226 Ninderry Road'],['OB135196','50 ROSECLIFFE Street'],['OB135197','44190 BRUCE Highway'],['OB135198','88-94 GLOVER Circuit'],['OB135199','360 UPPER BROOKFIELD Road'],['OB135200','9 HARROW Street'],['OB135201','22 WAHROONGA Road'],['OB135202','14 GARDINER Street'],['OB135203','52 Gordon Street'],['OB135204','4 HELICONIA Court'],['OB135205','165 JOCELYN Drive'],['OB135206','88 COLBURN Avenue'],['OB135207','10 MARCEL Street'],['OB135208','188 WEBSTER Road'],['OB135209','302 Buckland Road'],['OB135210','31 GLENGYLE PLACE'],['OB135211','24 ROSS STREET'],['OB135212','1790 Maleny-Stanley River Road']]

#tasks = range(1320000, 0, -1)
#tasks = [1008531,1033596,1199139,78120,1200115,1199456,1138780,1008032,1096103,1268852,1256130,56714,1117517,31645,1201601,1174611,1127956,1308188,1144021,1032862,1148362,51497,1176258,1180632,1209719,1089069,82109,82109,1147412,1281355,1041620,1115793,1211341,1223760,1130049,1022648,1246976,71474,1091770,1187642,1164394,1163228,1165125,1026479,1075037,1175998,12816,1275276,1188541,1189818,1056639,1210033,1284128,1201644,1175245,1101029,1144908,1163345,1257483,1084114,1318040,1238035,1272446,1202425,1129327,46869,1181070,71628,1012389,24327,1126504,1114233,1296817,54832,1094022,1192669,42847,1309936,1124847,1131628,14325,66699,1202602,74081,1084517,20706,74525,1317532,1270317,1126783,1073611,1312726,62497,19760,1139785,1319149,1158346,1105464,1192433,10410,66985,1161095,19543,1120733,1123427,81890,24448,1197106,21428,1088239,51454,1199332,1062945,1204369,1110837,64637,1188419,1227405,47089,1179136,1306996,1035129,81897,1061173,1010429,74690,1269261,1303164,1080506,1113822,1150243,62479,1219806,1100029,1105064,1190202,1111050,1313147,1145303,1279643,1319128,1032740,1073677,70589,1209195,1308344,1087312,1270816,1176589,1102252,1181506,53803,1180364,1286883,45842,1208270,1302528,1148005,1050874,1161742,1089846,1107503,1248865,11233,1181917,1182048,1075312,1160689,1304942,75660,1251562,1280899,1103727,1224865,41951,1145530,73198,50615,1284954,1311700,1247870,1141458,1276975,1175794,70776,25190,1048645,1082032,1202763,1110794,1138019,1121920,743249,1187836,1145817,21028,18888,1002863,1261990,1009505,1212472,1268236,1033955,1108134,1027532,889130,1150013,1164594,1060207,1071190,50871,1250267,1309497]
